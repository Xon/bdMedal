<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="account_visitor_menu" modification_key="bdmedal_account_visitor_menu" description="Link in visitor menu." execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[#(\n(\s+))<!--\[XF:account_links:bottom\]-->#
]]></find>
    <replace><![CDATA[$1<xf:if is="{{ property('bdMedal_showVisitorMenuLink') }}">
$2	<li><a href="{{ link('members/medals', $xf.visitor) }}" class="menu-linkRow" data-xf-click="overlay">{{ phrase('bdmedal_medals') }}</a></li>
$2</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="member_macros" modification_key="bdmedal_member_view_moderator_menu_actions" description="Link in member's moderator menu." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:moderator_menu:bottom]-->
]]></find>
    <replace><![CDATA[$0

<xf:macro template="bdmedal_member_view_macros" name="moderator_menu_actions" arg-user="{$user}"/>
]]></replace>
  </modification>
  <modification type="public" template="member_macros" modification_key="bdmedal_member_view_stat_pair" description="Medal count on profile page." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:stat_pairs:below_trophies]-->]]></find>
    <replace><![CDATA[$0

<xf:macro template="bdmedal_member_view_macros" name="stat_pair" arg-user="{$user}"/>
]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="bdmedal_member_view_tabs" description="Tab on profile page." execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:(tabs|tab_panes):after_recent_content\]-->/]]></find>
    <replace><![CDATA[$0

<xf:macro template="bdmedal_member_view_macros" name="$1" arg-user="{$user}"/>
]]></replace>
  </modification>
  <modification type="public" template="message_macros" modification_key="bdmedal_message_user_info_extra_xxx" description="message_user_info_extra_(top|bottom)" execution_order="4294967295" enabled="1" action="preg_replace">
    <find><![CDATA[#((\t+)<div class="message-userExtras">\s+<xf:contentcheck>)(.+?)(</xf:contentcheck>\n\2</div>)#s]]></find>
    <replace><![CDATA[$1

<xf:if is="$xf.options.bdMedal_positionInPost === 'message_user_info_extra_top'">
	<xf:macro template="bdmedal_message_macros" name="user_medals"
			  arg-position="message_user_info_extra_top"
			  arg-user="{$user}"/>
</xf:if>

$3
<xf:if is="$xf.options.bdMedal_positionInPost === 'message_user_info_extra_bottom'">
	<xf:macro template="bdmedal_message_macros" name="user_medals"
			  arg-position="message_user_info_extra_bottom"
			  arg-user="{$user}"/>
</xf:if>


$2$4]]></replace>
  </modification>
  <modification type="public" template="message_macros" modification_key="message_user_info_text_x" description="message_user_info_text_(top|bottom)" execution_order="4294967295" enabled="1" action="preg_replace">
    <find><![CDATA[#(\t+)<div class="message-userDetails">.+?\n\1</div>#s]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.bdMedal_positionInPost === 'message_user_info_text_top'">
	<xf:macro template="bdmedal_message_macros" name="user_medals"
			  arg-position="message_user_info_text_top"
			  arg-user="{$user}"/>
</xf:if>

$0

<xf:if is="$xf.options.bdMedal_positionInPost === 'message_user_info_text_bottom'">
	<xf:macro template="bdmedal_message_macros" name="user_medals"
			  arg-position="message_user_info_text_bottom"
			  arg-user="{$user}"/>
</xf:if>
]]></replace>
  </modification>
</template_modifications>
